{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dmitrykoptev/Documents/GitHub/keysee/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/dmitrykoptev/Documents/GitHub/keysee/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{keysAction}from\"./keys\";import{notificationActions}from\"./notification\";export var fetchKeysData=function fetchKeysData(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var fetchData,keyList;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"/api/v1/keys\",{method:\"GET\",headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\")),\"Content-Type\":\"application/json\"}});case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;return _context.abrupt(\"return\",data);case 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref2.apply(this,arguments);};}();_context2.prev=1;_context2.next=4;return fetchData();case 4:keyList=_context2.sent;dispatch(keysAction.replaceKeys({items:keyList||[],quantity:keyList.length}));_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch(notificationActions.showNotification({status:\"error\",message:\"Fetching keys failed!\"}));setTimeout(function(){dispatch(notificationActions.hideNotification());},1500);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var addKey=function addKey(keyItem){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var sendRequest;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:sendRequest=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"/api/v1/keys\",{method:\"POST\",body:JSON.stringify({key:keyItem}),headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\")),\"Content-Type\":\"application/json\"}});case 2:response=_context3.sent;if(response.ok){_context3.next=5;break;}throw new Error(\"Something went wrong ...\");case 5:dispatch(fetchKeysData());case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function sendRequest(){return _ref4.apply(this,arguments);};}();_context4.prev=1;_context4.next=4;return sendRequest();case 4:_context4.next=9;break;case 6:_context4.prev=6;_context4.t0=_context4[\"catch\"](1);console.log(_context4.t0.message);case 9:case\"end\":return _context4.stop();}}},_callee4,null,[[1,6]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};export var deleteKey=function deleteKey(id){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(dispatch){var sendRequest;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:sendRequest=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var response;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return fetch(\"/api/v1/keys\",{method:\"DELETE\",body:JSON.stringify({id:id}),headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\")),\"Content-Type\":\"application/json\"}});case 2:response=_context5.sent;if(response.ok){_context5.next=5;break;}throw new Error(\"Something went wrong ...\");case 5:dispatch(fetchKeysData());case 6:case\"end\":return _context5.stop();}}},_callee5);}));return function sendRequest(){return _ref6.apply(this,arguments);};}();_context6.prev=1;_context6.next=4;return sendRequest();case 4:_context6.next=9;break;case 6:_context6.prev=6;_context6.t0=_context6[\"catch\"](1);// диспатчить ошибку из стейта\nconsole.log(_context6.t0.message);case 9:case\"end\":return _context6.stop();}}},_callee6,null,[[1,6]]);}));return function(_x3){return _ref5.apply(this,arguments);};}();};","map":{"version":3,"names":["keysAction","notificationActions","fetchKeysData","dispatch","fetchData","fetch","method","headers","Authorization","localStorage","getItem","response","json","data","keyList","replaceKeys","items","quantity","length","showNotification","status","message","setTimeout","hideNotification","addKey","keyItem","sendRequest","body","JSON","stringify","key","ok","Error","console","log","deleteKey","id"],"sources":["/Users/dmitrykoptev/Documents/GitHub/keysee/src/store/keys-actions.js"],"sourcesContent":["import { keysAction } from \"./keys\";\nimport { notificationActions } from \"./notification\";\n\nexport const fetchKeysData = () => {\n  return async (dispatch) => {\n    const fetchData = async () => {\n      const response = await fetch(\"/api/v1/keys\", {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      const data = await response.json();\n      return data;\n    };\n\n    try {\n      const keyList = await fetchData();\n      dispatch(\n        keysAction.replaceKeys({\n          items: keyList || [],\n          quantity: keyList.length,\n        })\n      );\n    } catch (error) {\n      dispatch(\n        notificationActions.showNotification({\n          status: \"error\",\n          message: \"Fetching keys failed!\",\n        })\n      );\n      setTimeout(() => {\n        dispatch(notificationActions.hideNotification());\n      }, 1500);\n    }\n  };\n};\n\nexport const addKey = (keyItem) => {\n  return async (dispatch) => {\n    const sendRequest = async () => {\n      const response = await fetch(\"/api/v1/keys\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          key: keyItem,\n        }),\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Something went wrong ...\");\n      }\n      dispatch(fetchKeysData());\n    };\n\n    try {\n      await sendRequest();\n    } catch (err) {\n      console.log(err.message);\n    }\n  };\n};\n\nexport const deleteKey = (id) => {\n  return async (dispatch) => {\n    const sendRequest = async function () {\n      const response = await fetch(\"/api/v1/keys\", {\n        method: \"DELETE\",\n        body: JSON.stringify({\n          id: id,\n        }),\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Something went wrong ...\");\n      }\n\n      dispatch(fetchKeysData());\n    };\n\n    try {\n      await sendRequest();\n    } catch (err) {\n      // диспатчить ошибку из стейта\n      console.log(err.message);\n    }\n  };\n};\n"],"mappings":"kRAAA,OAASA,UAAU,KAAQ,QAAQ,CACnC,OAASC,mBAAmB,KAAQ,gBAAgB,CAEpD,MAAO,IAAMC,cAAa,CAAG,QAAhBA,cAAa,EAAS,CACjC,iGAAO,kBAAOC,QAAQ,8IACdC,SAAS,6FAAG,6KACOC,MAAK,CAAC,cAAc,CAAE,CAC3CC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACPC,aAAa,kBAAYC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxD,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,QANIC,QAAQ,qCAQKA,SAAQ,CAACC,IAAI,EAAE,QAA5BC,IAAI,+CACHA,IAAI,wDACZ,kBAXKT,UAAS,oFAcSA,UAAS,EAAE,QAA3BU,OAAO,gBACbX,QAAQ,CACNH,UAAU,CAACe,WAAW,CAAC,CACrBC,KAAK,CAAEF,OAAO,EAAI,EAAE,CACpBG,QAAQ,CAAEH,OAAO,CAACI,MACpB,CAAC,CAAC,CACH,CAAC,mFAEFf,QAAQ,CACNF,mBAAmB,CAACkB,gBAAgB,CAAC,CACnCC,MAAM,CAAE,OAAO,CACfC,OAAO,CAAE,uBACX,CAAC,CAAC,CACH,CACDC,UAAU,CAAC,UAAM,CACfnB,QAAQ,CAACF,mBAAmB,CAACsB,gBAAgB,EAAE,CAAC,CAClD,CAAC,CAAE,IAAI,CAAC,CAAC,sEAEZ,+DACH,CAAC,CAED,MAAO,IAAMC,OAAM,CAAG,QAATA,OAAM,CAAIC,OAAO,CAAK,CACjC,kGAAO,kBAAOtB,QAAQ,wIACduB,WAAW,6FAAG,8KACKrB,MAAK,CAAC,cAAc,CAAE,CAC3CC,MAAM,CAAE,MAAM,CACdqB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,GAAG,CAAEL,OACP,CAAC,CAAC,CACFlB,OAAO,CAAE,CACPC,aAAa,kBAAYC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxD,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,QATIC,QAAQ,mBAWTA,QAAQ,CAACoB,EAAE,+BACR,IAAIC,MAAK,CAAC,0BAA0B,CAAC,QAE7C7B,QAAQ,CAACD,aAAa,EAAE,CAAC,CAAC,wDAC3B,kBAhBKwB,YAAW,oFAmBTA,YAAW,EAAE,0FAEnBO,OAAO,CAACC,GAAG,CAAC,aAAIb,OAAO,CAAC,CAAC,qEAE5B,iEACH,CAAC,CAED,MAAO,IAAMc,UAAS,CAAG,QAAZA,UAAS,CAAIC,EAAE,CAAK,CAC/B,kGAAO,kBAAOjC,QAAQ,wIACduB,WAAW,6FAAG,8KACKrB,MAAK,CAAC,cAAc,CAAE,CAC3CC,MAAM,CAAE,QAAQ,CAChBqB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBO,EAAE,CAAEA,EACN,CAAC,CAAC,CACF7B,OAAO,CAAE,CACPC,aAAa,kBAAYC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxD,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,QATIC,QAAQ,mBAWTA,QAAQ,CAACoB,EAAE,+BACR,IAAIC,MAAK,CAAC,0BAA0B,CAAC,QAG7C7B,QAAQ,CAACD,aAAa,EAAE,CAAC,CAAC,wDAC3B,kBAjBKwB,YAAW,oFAoBTA,YAAW,EAAE,0FAEnB;AACAO,OAAO,CAACC,GAAG,CAAC,aAAIb,OAAO,CAAC,CAAC,qEAE5B,iEACH,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}