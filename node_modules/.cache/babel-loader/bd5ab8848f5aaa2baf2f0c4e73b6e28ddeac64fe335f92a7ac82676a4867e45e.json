{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ivylou/Desktop/pythonProject/keysee/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ivylou/Desktop/pythonProject/keysee/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ivylou/Desktop/pythonProject/keysee/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import classes from\"./AuthForm.module.css\";import logoMain from\"../../images/LogoMain.png\";import useInput from\"../../hooks/use-input\";import{useHistory}from\"react-router-dom\";import{useDispatch,useSelector}from\"react-redux\";import{authActions}from\"../../store/auth\";import MainButton from\"../Reusable/MainButton\";import PasswordInput from\"../Reusable/PasswordInput\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LoginForm=function LoginForm(){var history=useHistory();var dispatch=useDispatch();var isError=useSelector(function(state){return state.auth.error;});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),regComplete=_useState2[0],setRegComplete=_useState2[1];var _useInput=useInput(function(value){return value.includes(\"@\")&&value.includes(\".\")&&value.trim().length>=6;}),enteredEmail=_useInput.value,emailInputHasError=_useInput.hasError,enteredEmailIsValid=_useInput.isValid,emailChangedHandler=_useInput.valueChangeHandler,emailBlurHandler=_useInput.inputBlurHandler,emailFocusHandler=_useInput.inputFocusHandler,resetEmailInput=_useInput.reset;var _useInput2=useInput(function(value){return value.trim().length>=6;}),enteredPassword=_useInput2.value,passwordInputHasError=_useInput2.hasError,enteredPasswordIsValid=_useInput2.isValid,passwordChangedHandler=_useInput2.valueChangeHandler,passwordBlurHandler=_useInput2.inputBlurHandler,resetPasswordInput=_useInput2.reset;var formIsValid=false;if(enteredEmailIsValid&&enteredPasswordIsValid){formIsValid=true;}var validationError=false;if(emailInputHasError||passwordInputHasError){validationError=true;}var submitHandler=function submitHandler(event){event.preventDefault();var sendRequest=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"/api/v1/register\",{method:\"POST\",body:JSON.stringify({email:enteredEmail,password:enteredPassword}),headers:{\"Content-Type\":\"application/json\"}});case 2:response=_context.sent;if(response.ok){_context.next=5;break;}throw new Error(\"This email already exists\");case 5:_context.next=7;return response.json();case 7:data=_context.sent;setRegComplete(true);setTimeout(function(){setRegComplete(false);dispatch(authActions.logIn(data.access_token));},2000);case 10:case\"end\":return _context.stop();}}},_callee);}));return function sendRequest(){return _ref.apply(this,arguments);};}();try{sendRequest();}catch(err){dispatch(authActions.showError(err.message));}document.activeElement.blur();resetEmailInput();resetPasswordInput();};var signInHandler=function signInHandler(){history.replace(\"/login\");dispatch(authActions.removeError());};var emailInputClasses=emailInputHasError||isError?\"formInput wrongCredentials\":\"formInput\";return/*#__PURE__*/_jsxs(\"div\",{className:classes.container,children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,className:classes.loginForm,children:[!regComplete&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Sign Up\"}),/*#__PURE__*/_jsxs(\"div\",{className:classes.newUser,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Have an account?\"}),/*#__PURE__*/_jsx(\"span\",{onClick:signInHandler,children:\"Sign in.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"inputsContainer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\",className:emailInputClasses,value:enteredEmail,onChange:emailChangedHandler,onBlur:emailBlurHandler,onFocus:emailFocusHandler}),/*#__PURE__*/_jsx(PasswordInput,{inputType:\"password\",enteredPassword:enteredPassword,passwordInputHasError:passwordInputHasError,enteredPasswordIsValid:enteredPasswordIsValid,passwordChangedHandler:passwordChangedHandler,passwordBlurHandler:passwordBlurHandler,resetPasswordInput:resetPasswordInput,placeholder:\"Password\"})]}),validationError&&/*#__PURE__*/_jsx(\"p\",{className:classes.errorText,children:\"Please enter correct email & password.\"}),isError&&/*#__PURE__*/_jsx(\"p\",{className:classes.errorText,children:isError.errorMessage}),/*#__PURE__*/_jsx(MainButton,{title:\"Sign Up\",type:\"submit\",disabled:!formIsValid})]}),regComplete&&/*#__PURE__*/_jsxs(\"span\",{className:classes.sucessReg,children:[\"Congratulations!\",/*#__PURE__*/_jsx(\"br\",{}),\"You have successfully registered!\"]})]}),/*#__PURE__*/_jsx(\"img\",{src:logoMain,alt:\"keysee\",className:classes.mainLogo})]});};export default LoginForm;","map":{"version":3,"names":["React","useState","classes","logoMain","useInput","useHistory","useDispatch","useSelector","authActions","MainButton","PasswordInput","LoginForm","history","dispatch","isError","state","auth","error","regComplete","setRegComplete","value","includes","trim","length","enteredEmail","emailInputHasError","hasError","enteredEmailIsValid","isValid","emailChangedHandler","valueChangeHandler","emailBlurHandler","inputBlurHandler","emailFocusHandler","inputFocusHandler","resetEmailInput","reset","enteredPassword","passwordInputHasError","enteredPasswordIsValid","passwordChangedHandler","passwordBlurHandler","resetPasswordInput","formIsValid","validationError","submitHandler","event","preventDefault","sendRequest","fetch","method","body","JSON","stringify","email","password","headers","response","ok","Error","json","data","setTimeout","logIn","access_token","err","showError","message","document","activeElement","blur","signInHandler","replace","removeError","emailInputClasses","container","loginForm","newUser","errorText","errorMessage","sucessReg","mainLogo"],"sources":["/Users/ivylou/Desktop/pythonProject/keysee/src/components/Login/RegisterForm.js"],"sourcesContent":["import React, { useState } from \"react\";\n\nimport classes from \"./AuthForm.module.css\";\nimport logoMain from \"../../images/LogoMain.png\";\nimport useInput from \"../../hooks/use-input\";\nimport { useHistory } from \"react-router-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { authActions } from \"../../store/auth\";\nimport MainButton from \"../Reusable/MainButton\";\nimport PasswordInput from \"../Reusable/PasswordInput\";\n\nconst LoginForm = () => {\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const isError = useSelector((state) => state.auth.error);\n  const [regComplete, setRegComplete] = useState(false);\n\n  const {\n    value: enteredEmail,\n    hasError: emailInputHasError,\n    isValid: enteredEmailIsValid,\n    valueChangeHandler: emailChangedHandler,\n    inputBlurHandler: emailBlurHandler,\n    inputFocusHandler: emailFocusHandler,\n    reset: resetEmailInput,\n  } = useInput(\n    (value) =>\n      value.includes(\"@\") && value.includes(\".\") && value.trim().length >= 6\n  );\n\n  const {\n    value: enteredPassword,\n    hasError: passwordInputHasError,\n    isValid: enteredPasswordIsValid,\n    valueChangeHandler: passwordChangedHandler,\n    inputBlurHandler: passwordBlurHandler,\n    reset: resetPasswordInput,\n  } = useInput((value) => value.trim().length >= 6);\n\n  let formIsValid = false;\n  if (enteredEmailIsValid && enteredPasswordIsValid) {\n    formIsValid = true;\n  }\n\n  let validationError = false;\n  if (emailInputHasError || passwordInputHasError) {\n    validationError = true;\n  }\n\n  const submitHandler = (event) => {\n    event.preventDefault();\n\n    const sendRequest = async () => {\n      const response = await fetch(\"/api/v1/register\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          email: enteredEmail,\n          password: enteredPassword,\n        }),\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(\"This email already exists\");\n      }\n\n      const data = await response.json();\n      setRegComplete(true);\n      setTimeout(() => {\n        setRegComplete(false);\n        dispatch(authActions.logIn(data.access_token));\n      }, 2000);\n    };\n\n    try {\n      sendRequest();\n    } catch (err) {\n      dispatch(authActions.showError(err.message));\n    }\n\n    document.activeElement.blur();\n    resetEmailInput();\n    resetPasswordInput();\n  };\n\n  const signInHandler = () => {\n    history.replace(\"/login\");\n    dispatch(authActions.removeError());\n  };\n\n  const emailInputClasses =\n    emailInputHasError || isError ? `formInput wrongCredentials` : `formInput`;\n\n  return (\n    <div className={classes.container}>\n      <form onSubmit={submitHandler} className={classes.loginForm}>\n        {!regComplete && (\n          <>\n            <h1>Sign Up</h1>\n            <div className={classes.newUser}>\n              <p>Have an account?</p>\n              <span onClick={signInHandler}>Sign in.</span>\n            </div>\n            <div className=\"inputsContainer\">\n              <input\n                type=\"email\"\n                placeholder=\"Email\"\n                className={emailInputClasses}\n                value={enteredEmail}\n                onChange={emailChangedHandler}\n                onBlur={emailBlurHandler}\n                onFocus={emailFocusHandler}\n              ></input>\n              <PasswordInput\n                inputType=\"password\"\n                enteredPassword={enteredPassword}\n                passwordInputHasError={passwordInputHasError}\n                enteredPasswordIsValid={enteredPasswordIsValid}\n                passwordChangedHandler={passwordChangedHandler}\n                passwordBlurHandler={passwordBlurHandler}\n                resetPasswordInput={resetPasswordInput}\n                placeholder=\"Password\"\n              />\n            </div>\n            {validationError && (\n              <p className={classes.errorText}>\n                Please enter correct email & password.\n              </p>\n            )}\n            {isError && (\n              <p className={classes.errorText}>{isError.errorMessage}</p>\n            )}\n            <MainButton title=\"Sign Up\" type=\"submit\" disabled={!formIsValid} />\n          </>\n        )}\n        {regComplete && (\n          <span className={classes.sucessReg}>\n            Congratulations!\n            <br />\n            You have successfully registered!\n          </span>\n        )}\n      </form>\n      <img src={logoMain} alt=\"keysee\" className={classes.mainLogo} />\n    </div>\n  );\n};\n\nexport default LoginForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}