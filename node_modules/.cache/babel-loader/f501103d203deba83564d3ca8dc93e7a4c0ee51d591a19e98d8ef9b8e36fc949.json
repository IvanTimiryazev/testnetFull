{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ivylou/Desktop/pythonProject/keysee/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ivylou/Desktop/pythonProject/keysee/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import{useDispatch}from\"react-redux\";import useInput from\"../../../hooks/use-input\";import{modalActions}from\"../../../store/modals\";import{callNotification}from\"../../../store/notification-actions\";import MainButton from\"../../Reusable/MainButton\";import Modal from\"../../Reusable/Modal\";import PasswordInput from\"../../Reusable/PasswordInput\";import classes from\"./ChangePasswordModal.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChangePasswordModal=function ChangePasswordModal(props){var dispatch=useDispatch();var _useInput=useInput(function(value){return value.trim().length>=6;}),enteredPasswordOld=_useInput.value,passwordInputHasErrorOld=_useInput.hasError,enteredPasswordIsValidOld=_useInput.isValid,passwordChangedHandlerOld=_useInput.valueChangeHandler,passwordBlurHandlerOld=_useInput.inputBlurHandler,resetPasswordInputOld=_useInput.reset;var _useInput2=useInput(function(value){return value.trim().length>=6;}),enteredPassword=_useInput2.value,passwordInputHasError=_useInput2.hasError,enteredPasswordIsValid=_useInput2.isValid,passwordChangedHandler=_useInput2.valueChangeHandler,passwordBlurHandler=_useInput2.inputBlurHandler,resetPasswordInput=_useInput2.reset;var _useInput3=useInput(function(value){return value.trim().length>=6;}),enteredPasswordRepeat=_useInput3.value,passwordInputHasErrorRepeat=_useInput3.hasError,enteredPasswordIsValidRepeat=_useInput3.isValid,passwordChangedHandlerRepeat=_useInput3.valueChangeHandler,passwordBlurHandlerRepeat=_useInput3.inputBlurHandler,resetPasswordInputRepeat=_useInput3.reset;var resetForm=function resetForm(){resetPasswordInputOld();resetPasswordInput();resetPasswordInputRepeat();};var validationError;if(passwordInputHasErrorOld||passwordInputHasError||passwordInputHasErrorRepeat){validationError=true;}var formIsValid=false;if(enteredPasswordIsValid&&enteredPassword===enteredPasswordRepeat){formIsValid=true;}var submitHandler=function submitHandler(event){event.preventDefault();var sendRequest=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"api/v1/edit_password\",{method:\"PUT\",body:JSON.stringify({current_password:enteredPasswordOld,password:enteredPassword}),headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\")),\"Content-Type\":\"application/json\"}});case 2:response=_context.sent;document.activeElement.blur();resetPasswordInputOld();resetPasswordInput();resetPasswordInputRepeat();if(response.ok){_context.next=13;break;}if(!(response.status===400)){_context.next=12;break;}throw new Error(\"Wrong current password.\");case 12:throw new Error(\"Something went wrong. Please try again.\");case 13:dispatch(modalActions.closeModal());dispatch(callNotification(\"success\",\"Your password has been changed successfully!\"));case 15:case\"end\":return _context.stop();}}},_callee);}));return function sendRequest(){return _ref.apply(this,arguments);};}();try{sendRequest();}catch(err){dispatch(callNotification(\"error\",err.message));}};return/*#__PURE__*/_jsx(Modal,{modalType:\"changePassword\",reset:resetForm,show:props.show,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.container,children:[/*#__PURE__*/_jsx(\"span\",{className:classes.title,children:\"Change password\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inputsContainer\",children:[/*#__PURE__*/_jsx(PasswordInput,{inputType:\"password\",enteredPassword:enteredPasswordOld,passwordInputHasError:passwordInputHasErrorOld,enteredPasswordIsValid:enteredPasswordIsValidOld,passwordChangedHandler:passwordChangedHandlerOld,passwordBlurHandler:passwordBlurHandlerOld,resetPasswordInput:resetPasswordInputOld,placeholder:\"Current password\"}),/*#__PURE__*/_jsx(PasswordInput,{inputType:\"password\",enteredPassword:enteredPassword,passwordInputHasError:passwordInputHasError,enteredPasswordIsValid:enteredPasswordIsValid,passwordChangedHandler:passwordChangedHandler,passwordBlurHandler:passwordBlurHandler,resetPasswordInput:resetPasswordInput,placeholder:\"New password\"}),/*#__PURE__*/_jsx(PasswordInput,{inputType:\"password\",enteredPassword:enteredPasswordRepeat,passwordInputHasError:passwordInputHasErrorRepeat,enteredPasswordIsValid:enteredPasswordIsValidRepeat,passwordChangedHandler:passwordChangedHandlerRepeat,passwordBlurHandler:passwordBlurHandlerRepeat,resetPasswordInput:resetPasswordInputRepeat,placeholder:\"New password\"})]}),validationError&&/*#__PURE__*/_jsx(\"span\",{className:classes.errorText,children:\"Password can't be less then 6 symbols.\"}),/*#__PURE__*/_jsx(MainButton,{title:\"Confirm\",type:\"submit\",disabled:!formIsValid})]})]})});};export default ChangePasswordModal;","map":{"version":3,"names":["React","useDispatch","useInput","modalActions","callNotification","MainButton","Modal","PasswordInput","classes","ChangePasswordModal","props","dispatch","value","trim","length","enteredPasswordOld","passwordInputHasErrorOld","hasError","enteredPasswordIsValidOld","isValid","passwordChangedHandlerOld","valueChangeHandler","passwordBlurHandlerOld","inputBlurHandler","resetPasswordInputOld","reset","enteredPassword","passwordInputHasError","enteredPasswordIsValid","passwordChangedHandler","passwordBlurHandler","resetPasswordInput","enteredPasswordRepeat","passwordInputHasErrorRepeat","enteredPasswordIsValidRepeat","passwordChangedHandlerRepeat","passwordBlurHandlerRepeat","resetPasswordInputRepeat","resetForm","validationError","formIsValid","submitHandler","event","preventDefault","sendRequest","fetch","method","body","JSON","stringify","current_password","password","headers","Authorization","localStorage","getItem","response","document","activeElement","blur","ok","status","Error","closeModal","err","message","show","container","title","errorText"],"sources":["/Users/ivylou/Desktop/pythonProject/keysee/src/components/Header/MenuModals/ChangePasswordModal.js"],"sourcesContent":["import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport useInput from \"../../../hooks/use-input\";\nimport { modalActions } from \"../../../store/modals\";\nimport { callNotification } from \"../../../store/notification-actions\";\nimport MainButton from \"../../Reusable/MainButton\";\nimport Modal from \"../../Reusable/Modal\";\nimport PasswordInput from \"../../Reusable/PasswordInput\";\n\nimport classes from \"./ChangePasswordModal.module.css\";\n\nconst ChangePasswordModal = (props) => {\n  const dispatch = useDispatch();\n\n  let {\n    value: enteredPasswordOld,\n    hasError: passwordInputHasErrorOld,\n    isValid: enteredPasswordIsValidOld,\n    valueChangeHandler: passwordChangedHandlerOld,\n    inputBlurHandler: passwordBlurHandlerOld,\n    reset: resetPasswordInputOld,\n  } = useInput((value) => value.trim().length >= 6);\n\n  let {\n    value: enteredPassword,\n    hasError: passwordInputHasError,\n    isValid: enteredPasswordIsValid,\n    valueChangeHandler: passwordChangedHandler,\n    inputBlurHandler: passwordBlurHandler,\n    reset: resetPasswordInput,\n  } = useInput((value) => value.trim().length >= 6);\n\n  let {\n    value: enteredPasswordRepeat,\n    hasError: passwordInputHasErrorRepeat,\n    isValid: enteredPasswordIsValidRepeat,\n    valueChangeHandler: passwordChangedHandlerRepeat,\n    inputBlurHandler: passwordBlurHandlerRepeat,\n    reset: resetPasswordInputRepeat,\n  } = useInput((value) => value.trim().length >= 6);\n\n  const resetForm = () => {\n    resetPasswordInputOld();\n    resetPasswordInput();\n    resetPasswordInputRepeat();\n  };\n\n  let validationError;\n  if (\n    passwordInputHasErrorOld ||\n    passwordInputHasError ||\n    passwordInputHasErrorRepeat\n  ) {\n    validationError = true;\n  }\n\n  let formIsValid = false;\n  if (enteredPasswordIsValid && enteredPassword === enteredPasswordRepeat) {\n    formIsValid = true;\n  }\n\n  const submitHandler = (event) => {\n    event.preventDefault();\n\n    const sendRequest = async () => {\n      const response = await fetch(\"api/v1/edit_password\", {\n        method: \"PUT\",\n        body: JSON.stringify({\n          current_password: enteredPasswordOld,\n          password: enteredPassword,\n        }),\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      document.activeElement.blur();\n      resetPasswordInputOld();\n      resetPasswordInput();\n      resetPasswordInputRepeat();\n\n      if (!response.ok) {\n        if (response.status === 400) {\n          throw new Error(\"Wrong current password.\");\n        } else {\n          throw new Error(\"Something went wrong. Please try again.\");\n        }\n      }\n\n      dispatch(modalActions.closeModal());\n      dispatch(\n        callNotification(\n          \"success\",\n          \"Your password has been changed successfully!\"\n        )\n      );\n    };\n\n    try {\n      sendRequest();\n    } catch (err) {\n      dispatch(callNotification(\"error\", err.message));\n    }\n  };\n\n  return (\n    <Modal modalType=\"changePassword\" reset={resetForm} show={props.show}>\n      <div className={classes.container}>\n        <span className={classes.title}>Change password</span>\n        <form onSubmit={submitHandler}>\n          <div className=\"inputsContainer\">\n            <PasswordInput\n              inputType=\"password\"\n              enteredPassword={enteredPasswordOld}\n              passwordInputHasError={passwordInputHasErrorOld}\n              enteredPasswordIsValid={enteredPasswordIsValidOld}\n              passwordChangedHandler={passwordChangedHandlerOld}\n              passwordBlurHandler={passwordBlurHandlerOld}\n              resetPasswordInput={resetPasswordInputOld}\n              placeholder=\"Current password\"\n            />\n            <PasswordInput\n              inputType=\"password\"\n              enteredPassword={enteredPassword}\n              passwordInputHasError={passwordInputHasError}\n              enteredPasswordIsValid={enteredPasswordIsValid}\n              passwordChangedHandler={passwordChangedHandler}\n              passwordBlurHandler={passwordBlurHandler}\n              resetPasswordInput={resetPasswordInput}\n              placeholder=\"New password\"\n            />\n            <PasswordInput\n              inputType=\"password\"\n              enteredPassword={enteredPasswordRepeat}\n              passwordInputHasError={passwordInputHasErrorRepeat}\n              enteredPasswordIsValid={enteredPasswordIsValidRepeat}\n              passwordChangedHandler={passwordChangedHandlerRepeat}\n              passwordBlurHandler={passwordBlurHandlerRepeat}\n              resetPasswordInput={resetPasswordInputRepeat}\n              placeholder=\"New password\"\n            />\n          </div>\n          {validationError && (\n            <span className={classes.errorText}>\n              Password can't be less then 6 symbols.\n            </span>\n          )}\n          <MainButton title=\"Confirm\" type=\"submit\" disabled={!formIsValid} />\n        </form>\n      </div>\n    </Modal>\n  );\n};\n\nexport default ChangePasswordModal;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}