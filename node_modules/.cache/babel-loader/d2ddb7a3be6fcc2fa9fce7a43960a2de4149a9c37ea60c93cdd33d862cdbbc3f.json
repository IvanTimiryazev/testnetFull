{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ivylou/Desktop/pythonProject/keysee/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ivylou/Desktop/pythonProject/keysee/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import{useDispatch}from\"react-redux\";import useInput from\"../../../hooks/use-input\";import{modalActions}from\"../../../store/modals\";import{callNotification}from\"../../../store/notification-actions\";import MainButton from\"../../Reusable/MainButton\";import Modal from\"../../Reusable/Modal\";import EmailInput from\"../../Reusable/PasswordInput\";import classes from\"./ChangePasswordModal.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChangeEmailModal=function ChangeEmailModal(props){var dispatch=useDispatch();var _useInput=useInput(function(value){return value.includes(\"@\")&&value.includes(\".\")&&value.trim().length>=6;}),enteredEmail=_useInput.value,emailInputHasError=_useInput.hasError,enteredEmailIsValid=_useInput.isValid,emailChangedHandler=_useInput.valueChangeHandler,emailBlurHandler=_useInput.inputBlurHandler,resetEmailInput=_useInput.reset;var _useInput2=useInput(function(value){return value.includes(\"@\")&&value.includes(\".\")&&value.trim().length>=6;}),enteredEmailRepeat=_useInput2.value,emailInputHasErrorRepeat=_useInput2.hasError,enteredEmailIsValidRepeat=_useInput2.isValid,emailChangedHandlerRepeat=_useInput2.valueChangeHandler,emailBlurHandlerRepeat=_useInput2.inputBlurHandler,resetEmailInputRepeat=_useInput2.reset;var resetForm=function resetForm(){resetEmailInput();resetEmailInputRepeat();};var validationError;if(emailInputHasError||emailInputHasErrorRepeat){validationError=true;}var formIsValid=false;if(enteredEmailIsValid&&enteredEmail===enteredEmailRepeat){formIsValid=true;}var submitHandler=function submitHandler(event){event.preventDefault();var sendRequest=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"api/v1/edit_profile\",{method:\"PUT\",body:JSON.stringify({email:enteredEmail}),headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\")),\"Content-Type\":\"application/json\"}});case 2:response=_context.sent;document.activeElement.blur();resetEmailInput();resetEmailInputRepeat();if(response.ok){_context.next=8;break;}throw new Error(\"Something went wrong. Please try again.\");case 8:dispatch(modalActions.closeModal());dispatch(callNotification(\"success\",\"Your email has been changed successfully!\"));case 10:case\"end\":return _context.stop();}}},_callee);}));return function sendRequest(){return _ref.apply(this,arguments);};}();try{sendRequest();}catch(err){dispatch(callNotification(\"error\",err.message));}};return/*#__PURE__*/_jsx(Modal,{modalType:\"changeEmail\",reset:resetForm,show:props.show,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.container,children:[/*#__PURE__*/_jsx(\"span\",{className:classes.title,children:\"Change email\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inputsContainer\",children:[/*#__PURE__*/_jsx(EmailInput,{inputType:\"email\",enteredEmail:enteredEmail,emailInputHasError:emailInputHasError,enteredEmailIsValid:enteredEmailIsValid,emailChangedHandler:emailChangedHandler,emailBlurHandler:emailBlurHandler,resetEmailInput:resetEmailInput,placeholder:\"New email\"}),/*#__PURE__*/_jsx(EmailInput,{inputType:\"email\",enteredEmail:enteredEmailRepeat,emailInputHasError:emailInputHasErrorRepeat,enteredEmailIsValid:enteredEmailIsValidRepeat,emailChangedHandler:emailChangedHandlerRepeat,emailBlurHandler:emailBlurHandlerRepeat,resetEmailInput:resetEmailInputRepeat,placeholder:\"Repeat email\"})]}),validationError&&/*#__PURE__*/_jsx(\"span\",{className:classes.errorText,children:\"Enter correct email please.\"}),/*#__PURE__*/_jsx(MainButton,{title:\"Confirm\",type:\"submit\",disabled:!formIsValid})]})]})});};export default ChangeEmailModal;","map":{"version":3,"names":["React","useDispatch","useInput","modalActions","callNotification","MainButton","Modal","EmailInput","classes","ChangeEmailModal","props","dispatch","value","includes","trim","length","enteredEmail","emailInputHasError","hasError","enteredEmailIsValid","isValid","emailChangedHandler","valueChangeHandler","emailBlurHandler","inputBlurHandler","resetEmailInput","reset","enteredEmailRepeat","emailInputHasErrorRepeat","enteredEmailIsValidRepeat","emailChangedHandlerRepeat","emailBlurHandlerRepeat","resetEmailInputRepeat","resetForm","validationError","formIsValid","submitHandler","event","preventDefault","sendRequest","fetch","method","body","JSON","stringify","email","headers","Authorization","localStorage","getItem","response","document","activeElement","blur","ok","Error","closeModal","err","message","show","container","title","errorText"],"sources":["/Users/ivylou/Desktop/pythonProject/keysee/src/components/Header/MenuModals/CnahgeEmailModal.js"],"sourcesContent":["import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport useInput from \"../../../hooks/use-input\";\nimport { modalActions } from \"../../../store/modals\";\nimport { callNotification } from \"../../../store/notification-actions\";\nimport MainButton from \"../../Reusable/MainButton\";\nimport Modal from \"../../Reusable/Modal\";\nimport EmailInput from \"../../Reusable/PasswordInput\";\n\nimport classes from \"./ChangePasswordModal.module.css\";\n\nconst ChangeEmailModal = (props) => {\n  const dispatch = useDispatch();\n\n  let {\n    value: enteredEmail,\n    hasError: emailInputHasError,\n    isValid: enteredEmailIsValid,\n    valueChangeHandler: emailChangedHandler,\n    inputBlurHandler: emailBlurHandler,\n    reset: resetEmailInput,\n  } = useInput(\n    (value) =>\n      value.includes(\"@\") && value.includes(\".\") && value.trim().length >= 6\n  );\n\n  let {\n    value: enteredEmailRepeat,\n    hasError: emailInputHasErrorRepeat,\n    isValid: enteredEmailIsValidRepeat,\n    valueChangeHandler: emailChangedHandlerRepeat,\n    inputBlurHandler: emailBlurHandlerRepeat,\n    reset: resetEmailInputRepeat,\n  } = useInput(\n    (value) =>\n      value.includes(\"@\") && value.includes(\".\") && value.trim().length >= 6\n  );\n\n  const resetForm = () => {\n    resetEmailInput();\n    resetEmailInputRepeat();\n  };\n\n  let validationError;\n  if (emailInputHasError || emailInputHasErrorRepeat) {\n    validationError = true;\n  }\n\n  let formIsValid = false;\n  if (enteredEmailIsValid && enteredEmail === enteredEmailRepeat) {\n    formIsValid = true;\n  }\n\n  const submitHandler = (event) => {\n    event.preventDefault();\n\n    const sendRequest = async () => {\n      const response = await fetch(\"api/v1/edit_profile\", {\n        method: \"PUT\",\n        body: JSON.stringify({\n          email: enteredEmail,\n        }),\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      document.activeElement.blur();\n      resetEmailInput();\n      resetEmailInputRepeat();\n\n      if (!response.ok) {\n        throw new Error(\"Something went wrong. Please try again.\");\n      }\n\n      dispatch(modalActions.closeModal());\n      dispatch(\n        callNotification(\"success\", \"Your email has been changed successfully!\")\n      );\n    };\n\n    try {\n      sendRequest();\n    } catch (err) {\n      dispatch(callNotification(\"error\", err.message));\n    }\n  };\n\n  return (\n    <Modal modalType=\"changeEmail\" reset={resetForm} show={props.show}>\n      <div className={classes.container}>\n        <span className={classes.title}>Change email</span>\n        <form onSubmit={submitHandler}>\n          <div className=\"inputsContainer\">\n            <EmailInput\n              inputType=\"email\"\n              enteredEmail={enteredEmail}\n              emailInputHasError={emailInputHasError}\n              enteredEmailIsValid={enteredEmailIsValid}\n              emailChangedHandler={emailChangedHandler}\n              emailBlurHandler={emailBlurHandler}\n              resetEmailInput={resetEmailInput}\n              placeholder=\"New email\"\n            />\n            <EmailInput\n              inputType=\"email\"\n              enteredEmail={enteredEmailRepeat}\n              emailInputHasError={emailInputHasErrorRepeat}\n              enteredEmailIsValid={enteredEmailIsValidRepeat}\n              emailChangedHandler={emailChangedHandlerRepeat}\n              emailBlurHandler={emailBlurHandlerRepeat}\n              resetEmailInput={resetEmailInputRepeat}\n              placeholder=\"Repeat email\"\n            />\n          </div>\n          {validationError && (\n            <span className={classes.errorText}>\n              Enter correct email please.\n            </span>\n          )}\n          <MainButton title=\"Confirm\" type=\"submit\" disabled={!formIsValid} />\n        </form>\n      </div>\n    </Modal>\n  );\n};\n\nexport default ChangeEmailModal;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}