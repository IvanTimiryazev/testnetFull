{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dmitrykoptev/Documents/GitHub/keysee/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/dmitrykoptev/Documents/GitHub/keysee/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{accountsActions}from\"./accounts\";import{notificationActions}from\"./notification\";export var fetchAccountsData=function fetchAccountsData(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var fetchData,accountsList;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"/api/v1/accounts\",{method:\"GET\",headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\")),\"Content-Type\":\"application/json\"}});case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;return _context.abrupt(\"return\",data);case 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref2.apply(this,arguments);};}();_context2.prev=1;_context2.next=4;return fetchData();case 4:accountsList=_context2.sent;dispatch(accountsActions.replaceAccounts({quantity:accountsList.length,items:accountsList||[]}));_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch(notificationActions.showNotification({status:\"error\",message:\"Fetching accounts failed!\"}));setTimeout(function(){dispatch(notificationActions.hideNotification());},1500);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var addAccount=function addAccount(accountName){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var sendRequest;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:sendRequest=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"/api/v1/accounts\",{method:\"POST\",body:JSON.stringify({account:accountName}),headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\")),\"Content-Type\":\"application/json\"}});case 2:response=_context3.sent;if(response.ok){_context3.next=5;break;}throw new Error(\"Something went wrong ...\");case 5:dispatch(fetchAccountsData());case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function sendRequest(){return _ref4.apply(this,arguments);};}();_context4.prev=1;_context4.next=4;return sendRequest();case 4:_context4.next=9;break;case 6:_context4.prev=6;_context4.t0=_context4[\"catch\"](1);console.log(_context4.t0.message);case 9:case\"end\":return _context4.stop();}}},_callee4,null,[[1,6]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();};export var deleteAccount=function deleteAccount(id){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(dispatch){var sendRequest;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:sendRequest=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var response;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return fetch(\"/api/v1/accounts\",{method:\"DELETE\",body:JSON.stringify({id:id}),headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"token\")),\"Content-Type\":\"application/json\"}});case 2:response=_context5.sent;if(response.ok){_context5.next=5;break;}throw new Error(\"Something went wrong ...\");case 5:dispatch(fetchAccountsData());case 6:case\"end\":return _context5.stop();}}},_callee5);}));return function sendRequest(){return _ref6.apply(this,arguments);};}();_context6.prev=1;_context6.next=4;return sendRequest();case 4:_context6.next=9;break;case 6:_context6.prev=6;_context6.t0=_context6[\"catch\"](1);// диспатчить ошибку из стейта\nconsole.log(_context6.t0.message);case 9:case\"end\":return _context6.stop();}}},_callee6,null,[[1,6]]);}));return function(_x3){return _ref5.apply(this,arguments);};}();};","map":{"version":3,"names":["accountsActions","notificationActions","fetchAccountsData","dispatch","fetchData","fetch","method","headers","Authorization","localStorage","getItem","response","json","data","accountsList","replaceAccounts","quantity","length","items","showNotification","status","message","setTimeout","hideNotification","addAccount","accountName","sendRequest","body","JSON","stringify","account","ok","Error","console","log","deleteAccount","id"],"sources":["/Users/dmitrykoptev/Documents/GitHub/keysee/src/store/accounts-actions.js"],"sourcesContent":["import { accountsActions } from \"./accounts\";\nimport { notificationActions } from \"./notification\";\n\nexport const fetchAccountsData = () => {\n  return async (dispatch) => {\n    const fetchData = async () => {\n      const response = await fetch(\"/api/v1/accounts\", {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      const data = await response.json();\n      return data;\n    };\n\n    try {\n      const accountsList = await fetchData();\n      dispatch(\n        accountsActions.replaceAccounts({\n          quantity: accountsList.length,\n          items: accountsList || [],\n        })\n      );\n    } catch (error) {\n      dispatch(\n        notificationActions.showNotification({\n          status: \"error\",\n          message: \"Fetching accounts failed!\",\n        })\n      );\n      setTimeout(() => {\n        dispatch(notificationActions.hideNotification());\n      }, 1500);\n    }\n  };\n};\n\nexport const addAccount = (accountName) => {\n  return async (dispatch) => {\n    const sendRequest = async function () {\n      const response = await fetch(\"/api/v1/accounts\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          account: accountName,\n        }),\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Something went wrong ...\");\n      }\n\n      dispatch(fetchAccountsData());\n    };\n\n    try {\n      await sendRequest();\n    } catch (err) {\n      console.log(err.message);\n    }\n  };\n};\n\nexport const deleteAccount = (id) => {\n  return async (dispatch) => {\n    const sendRequest = async function () {\n      const response = await fetch(\"/api/v1/accounts\", {\n        method: \"DELETE\",\n        body: JSON.stringify({\n          id: id,\n        }),\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Something went wrong ...\");\n      }\n\n      dispatch(fetchAccountsData());\n    };\n\n    try {\n      await sendRequest();\n    } catch (err) {\n      // диспатчить ошибку из стейта\n      console.log(err.message);\n    }\n  };\n};\n"],"mappings":"kRAAA,OAASA,eAAe,KAAQ,YAAY,CAC5C,OAASC,mBAAmB,KAAQ,gBAAgB,CAEpD,MAAO,IAAMC,kBAAiB,CAAG,QAApBA,kBAAiB,EAAS,CACrC,iGAAO,kBAAOC,QAAQ,mJACdC,SAAS,6FAAG,6KACOC,MAAK,CAAC,kBAAkB,CAAE,CAC/CC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACPC,aAAa,kBAAYC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxD,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,QANIC,QAAQ,qCAQKA,SAAQ,CAACC,IAAI,EAAE,QAA5BC,IAAI,+CACHA,IAAI,wDACZ,kBAXKT,UAAS,oFAccA,UAAS,EAAE,QAAhCU,YAAY,gBAClBX,QAAQ,CACNH,eAAe,CAACe,eAAe,CAAC,CAC9BC,QAAQ,CAAEF,YAAY,CAACG,MAAM,CAC7BC,KAAK,CAAEJ,YAAY,EAAI,EACzB,CAAC,CAAC,CACH,CAAC,mFAEFX,QAAQ,CACNF,mBAAmB,CAACkB,gBAAgB,CAAC,CACnCC,MAAM,CAAE,OAAO,CACfC,OAAO,CAAE,2BACX,CAAC,CAAC,CACH,CACDC,UAAU,CAAC,UAAM,CACfnB,QAAQ,CAACF,mBAAmB,CAACsB,gBAAgB,EAAE,CAAC,CAClD,CAAC,CAAE,IAAI,CAAC,CAAC,sEAEZ,+DACH,CAAC,CAED,MAAO,IAAMC,WAAU,CAAG,QAAbA,WAAU,CAAIC,WAAW,CAAK,CACzC,kGAAO,kBAAOtB,QAAQ,wIACduB,WAAW,6FAAG,8KACKrB,MAAK,CAAC,kBAAkB,CAAE,CAC/CC,MAAM,CAAE,MAAM,CACdqB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,OAAO,CAAEL,WACX,CAAC,CAAC,CACFlB,OAAO,CAAE,CACPC,aAAa,kBAAYC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxD,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,QATIC,QAAQ,mBAWTA,QAAQ,CAACoB,EAAE,+BACR,IAAIC,MAAK,CAAC,0BAA0B,CAAC,QAG7C7B,QAAQ,CAACD,iBAAiB,EAAE,CAAC,CAAC,wDAC/B,kBAjBKwB,YAAW,oFAoBTA,YAAW,EAAE,0FAEnBO,OAAO,CAACC,GAAG,CAAC,aAAIb,OAAO,CAAC,CAAC,qEAE5B,iEACH,CAAC,CAED,MAAO,IAAMc,cAAa,CAAG,QAAhBA,cAAa,CAAIC,EAAE,CAAK,CACnC,kGAAO,kBAAOjC,QAAQ,wIACduB,WAAW,6FAAG,8KACKrB,MAAK,CAAC,kBAAkB,CAAE,CAC/CC,MAAM,CAAE,QAAQ,CAChBqB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBO,EAAE,CAAEA,EACN,CAAC,CAAC,CACF7B,OAAO,CAAE,CACPC,aAAa,kBAAYC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxD,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,QATIC,QAAQ,mBAWTA,QAAQ,CAACoB,EAAE,+BACR,IAAIC,MAAK,CAAC,0BAA0B,CAAC,QAG7C7B,QAAQ,CAACD,iBAAiB,EAAE,CAAC,CAAC,wDAC/B,kBAjBKwB,YAAW,oFAoBTA,YAAW,EAAE,0FAEnB;AACAO,OAAO,CAACC,GAAG,CAAC,aAAIb,OAAO,CAAC,CAAC,qEAE5B,iEACH,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}